"use strict";(self["webpackChunkvue3_template"]=self["webpackChunkvue3_template"]||[]).push([[141],{491:function(e,l,t){t.d(l,{K5:function(){return i},T8:function(){return o},ZC:function(){return s},Zr:function(){return r},p:function(){return n},ss:function(){return d},tm:function(){return u}});var a=t(6569);const o=e=>a.d.request({url:"/gm/account/list",method:"get",params:e}),n=(e,l)=>a.d.request({url:`/gm/account/${e}/recharge`,method:"post",data:l}),i=e=>a.d.request({url:`/gm/account/${e}/reset_create_charac`,method:"post"}),u=e=>a.d.request({url:`/gm/account/${e}`,method:"delete"}),r=(e,l)=>a.d.request({url:`/gm/account/${e}/change_password`,method:"post",data:l}),s=(e,l)=>a.d.request({url:`/gm/account/${e}`,method:"put",data:l}),d=e=>a.d.request({url:"/gm/account",method:"post",data:e})},9456:function(e,l,t){t.d(l,{F3:function(){return o},WZ:function(){return i},_o:function(){return n}});var a=t(6569);const o=e=>a.d.request({url:`/gm/account/${e}/roles`,method:"get"}),n=(e,l)=>a.d.request({url:`/gm/roles/${e}/qp`,method:"put",data:l}),i=(e,l)=>a.d.request({url:`/gm/roles/${e}/pvp`,method:"put",data:l})},9136:function(e,l,t){t.d(l,{Z:function(){return v}});var a=t(7477),o=t(3396),n=t(7139);const i={class:"bot",style:{height:"20px","margin-bottom":"10px",background:"#fff"}},u={class:"bline-dotted"},r={class:"category-index"},s={class:"category-name"},d={style:{padding:"10px 30px 20px"}};function p(e,l,t,a,p,c){const m=(0,o.up)("el-col"),f=(0,o.up)("el-row");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(f,{class:(0,n.C_)(t.isLast?"last-step":"")},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{span:24},{default:(0,o.w5)((()=>[(0,o._)("div",i,[(0,o._)("div",u,[(0,o._)("div",r,(0,n.zw)(t.num),1),(0,o._)("div",s,(0,n.zw)(t.title),1)])])])),_:1})])),_:1},8,["class"]),(0,o._)("div",null,[(0,o._)("div",d,[(0,o._)("div",{class:(0,n.C_)(t.isLast?"last-div":"")},[(0,o.WI)(e.$slots,"default",{},void 0,!0)],2)])])])}var c={name:"PanelStep",props:{num:{type:[String,Number],required:!0,default:1},title:{type:String},isLast:{type:Boolean,default:!1}}},m=t(89);const f=(0,m.Z)(c,[["render",p],["__scopeId","data-v-10870d64"]]);var _=f;const w=(0,a.nz)(_);var v=w},2507:function(e,l,t){t.d(l,{Z:function(){return w}});var a=t(7477),o=(t(7658),t(3396)),n=t(7139),i=t(4274),u=t(2483);const r=e=>((0,o.dD)("data-v-221fb25f"),e=e(),(0,o.Cn)(),e),s={class:"pull-left"},d=r((()=>(0,o._)("span",{class:"icon-toinstlist"},null,-1)));var p=(0,o.aZ)({__name:"PanelTitle",props:{isLine:i.i.bool.def(!1),title:i.i.string.def("标题"),router:Object,backTitle:i.i.string.def("")},setup(e){const l=e,t=(0,u.tv)(),a=()=>{l.router?t.push({...l.router}):t.go(-1)};return(l,t)=>{const i=(0,o.up)("el-button"),u=(0,o.up)("el-row");return(0,o.wg)(),(0,o.j4)(u,null,{default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,n.C_)(["console-title clearfix",e.isLine?"bline":""]),style:{"min-height":"50px"}},[(0,o._)("div",s,[(0,o._)("h4",null,(0,n.zw)(e.title),1),Boolean(e.backTitle)?((0,o.wg)(),(0,o.j4)(i,{key:0,size:"small",class:"btn-small",onClick:a},{default:(0,o.w5)((()=>[d,(0,o._)("span",null,(0,n.zw)(e.backTitle),1)])),_:1})):(0,o.kq)("",!0),(0,o.WI)(l.$slots,"button")])],2)])),_:3})}}}),c=t(89);const m=(0,c.Z)(p,[["__scopeId","data-v-221fb25f"]]);var f=m;const _=(0,a.nz)(f);var w=_},7192:function(e,l,t){t.d(l,{Gu:function(){return o},OP:function(){return n}});var a=t(4870);async function o(e,l=!1){const t=(0,a.SU)(e).validate;return new Promise((e=>t(((t,a)=>e(l?{valid:t,object:a}:t)))))}async function n(e,l){const t=(0,a.SU)(e).validateField;return new Promise((e=>t(l,(l=>e(l)))))}},7477:function(e,l,t){t.d(l,{nz:function(){return a}});const a=(e,l)=>{if(e.install=t=>{for(const a of[e,...Object.values(l??{})])t.component(a.name,a)},l)for(const[t,a]of Object.entries(l))e[t]=a;return e}},2141:function(e,l,t){t.r(l),t.d(l,{default:function(){return j}});var a=t(3396),o=t(4870),n=t(2507),i=t(9136),u=t(7139),r=t(5134),s=t(7192),d=t(9456),p=t(6881);const c={class:"text-gray-lg sm"},m=(0,a._)("div",{style:{"margin-left":"100px"}},[(0,a._)("span",{class:"text-warning sm"},"注：角色转职后，可以修改！")],-1),f={class:"dialog-footer"};var _=(0,a.aZ)({__name:"RoleQPDialog",emits:["reloadRoles"],setup(e,{expose:l,emit:t}){const n=(0,o.qj)({visible:!1,title:""}),i=(0,o.iH)(),r=(0,o.qj)({qp:800}),_=(0,o.qj)({qp:[{type:"integer",min:0,message:"QP值至少未0",trigger:"blur"}]}),w=(0,o.iH)(null);let v=null;const g=e=>{n.visible=!0,n.title="修改QP",w.value=e.QP,v=e.charac_no,(0,a.Y3)((()=>{i.value.resetFields()}))},b=async()=>{const e=await(0,s.Gu)(i);if(e)try{await(0,d._o)(v,r),(0,p.PE)("更新成功"),n.visible=!1,t("reloadRoles")}catch(l){}};return l({showQpDialog:g}),(e,l)=>{const t=(0,a.up)("el-form-item"),o=(0,a.up)("el-input-number"),s=(0,a.up)("el-form"),d=(0,a.up)("el-col"),p=(0,a.up)("el-row"),v=(0,a.up)("el-button"),g=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(g,{modelValue:n.visible,"onUpdate:modelValue":l[2]||(l[2]=e=>n.visible=e),title:n.title,width:"600px","close-on-press-escape":!1,"close-on-click-modal":!1},{footer:(0,a.w5)((()=>[(0,a._)("span",f,[(0,a.Wm)(v,{onClick:l[1]||(l[1]=e=>n.visible=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("取 消")])),_:1}),(0,a.Wm)(v,{type:"primary",onClick:b},{default:(0,a.w5)((()=>[(0,a.Uk)("确 定")])),_:1})])])),default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,{span:22},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{model:r,rules:_,ref_key:"formRef",ref:i,"label-width":"100px"},{default:(0,a.w5)((()=>[(0,a.Wm)(t,{label:"现有QP"},{default:(0,a.w5)((()=>[(0,a._)("span",c,(0,u.zw)(w.value),1)])),_:1}),(0,a.Wm)(t,{label:"修改QP",prop:"qp"},{default:(0,a.w5)((()=>[(0,a.Wm)(o,{min:0,modelValue:r.qp,"onUpdate:modelValue":l[0]||(l[0]=e=>r.qp=e),modelModifiers:{number:!0}},null,8,["modelValue"])])),_:1}),m])),_:1},8,["model","rules"])])),_:1})])),_:1})])),_:1},8,["modelValue","title"])])}}});const w=_;var v=w;const g={class:"dialog-footer"};var b=(0,a.aZ)({__name:"RolePvpDialog",emits:["reloadRoles"],setup(e,{expose:l,emit:t}){const n=(0,o.qj)({visible:!1,title:""}),i=(0,o.iH)();let u=(0,o.qj)({win:0,pvp_grade:0,pvp_point:0});const c=(0,o.qj)({pvp_grade:[{type:"integer",min:0,max:34,message:"pk段位0至34",trigger:"blur"}]});let m=null;const f=e=>{n.visible=!0,n.title="修改PK段位",m=e.charac_no,(0,a.Y3)((()=>{(0,r.U5)(u,e.pvp),i.value.clearValidate()}))},_=async()=>{const e=await(0,s.Gu)(i);if(e)try{await(0,d.WZ)(m,u),(0,p.PE)("更新成功"),n.visible=!1,t("reloadRoles")}catch(l){}};return l({showPvpDialog:f}),(e,l)=>{const t=(0,a.up)("el-input-number"),r=(0,a.up)("el-form-item"),s=(0,a.up)("el-form"),d=(0,a.up)("el-col"),p=(0,a.up)("el-row"),m=(0,a.up)("el-button"),f=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(f,{modelValue:n.visible,"onUpdate:modelValue":l[4]||(l[4]=e=>n.visible=e),title:n.title,width:"600px","close-on-press-escape":!1,"close-on-click-modal":!1},{footer:(0,a.w5)((()=>[(0,a._)("span",g,[(0,a.Wm)(m,{onClick:l[3]||(l[3]=e=>n.visible=!1)},{default:(0,a.w5)((()=>[(0,a.Uk)("取 消")])),_:1}),(0,a.Wm)(m,{type:"primary",onClick:_},{default:(0,a.w5)((()=>[(0,a.Uk)("确 定")])),_:1})])])),default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,{span:22},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{model:(0,o.SU)(u),rules:c,ref_key:"formRef",ref:i,"label-width":"100px"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{label:"PK段位",prop:"pvp_grade"},{default:(0,a.w5)((()=>[(0,a.Wm)(t,{min:0,max:34,modelValue:(0,o.SU)(u).pvp_grade,"onUpdate:modelValue":l[0]||(l[0]=e=>(0,o.SU)(u).pvp_grade=e),modelModifiers:{number:!0}},null,8,["modelValue"])])),_:1}),(0,a.Wm)(r,{label:"胜利场次",prop:"win"},{default:(0,a.w5)((()=>[(0,a.Wm)(t,{min:0,modelValue:(0,o.SU)(u).win,"onUpdate:modelValue":l[1]||(l[1]=e=>(0,o.SU)(u).win=e),modelModifiers:{number:!0}},null,8,["modelValue"])])),_:1}),(0,a.Wm)(r,{label:"胜点",prop:"pvp_point"},{default:(0,a.w5)((()=>[(0,a.Wm)(t,{min:0,max:99,modelValue:(0,o.SU)(u).pvp_point,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,o.SU)(u).pvp_point=e),modelModifiers:{number:!0}},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1})])),_:1},8,["modelValue","title"])])}}});const h=b;var y=h;const W={key:0},k={key:1};var U=(0,a.aZ)({__name:"RolesTable",props:{data:{type:Array,required:!0,default:()=>[]},loading:{type:Boolean,required:!0,default:!1}},emits:["reloadRoles"],setup(e,{emit:l}){const t=(0,o.iH)(),n=e=>{t.value.showQpDialog(e)},i=(0,o.iH)(),s=e=>{i.value.showPvpDialog(e)},d=()=>{l("reloadRoles")};return(l,p)=>{const c=(0,a.up)("el-table-column"),m=(0,a.up)("el-button"),f=(0,a.up)("el-table"),_=(0,a.Q2)("loading");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.wy)(((0,a.wg)(),(0,a.j4)(f,{data:e.data,ref:"tableRef",border:""},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{prop:"charac_no",label:"角色编号",width:"120"}),(0,a.Wm)(c,{prop:"charac_name",label:"角色名称",width:"180"}),(0,a.Wm)(c,{prop:"money",label:"金币",width:"180"},{default:(0,a.w5)((e=>[(0,a._)("span",null,(0,u.zw)((0,o.SU)(r.T4)(e.row.money)),1)])),_:1}),(0,a.Wm)(c,{prop:"QP",label:"QP",width:"120"}),(0,a.Wm)(c,{prop:"create_time",label:"创建时间",width:"180"},{default:(0,a.w5)((e=>[(0,a._)("span",null,(0,u.zw)((0,o.SU)(r.vc)(e.row.create_time)),1)])),_:1}),(0,a.Wm)(c,{prop:"lev",label:"等级"}),(0,a.Wm)(c,{prop:"pvp.pvp_grade",label:"PK等级",width:"100"},{default:(0,a.w5)((e=>[e.row.pvp.pvp_grade?((0,a.wg)(),(0,a.iD)("span",W,(0,u.zw)(e.row.pvp.pvp_grade),1)):((0,a.wg)(),(0,a.iD)("span",k,"-"))])),_:1}),(0,a.Wm)(c,{label:"操作",width:"180",align:"right"},{default:(0,a.w5)((e=>[(0,a.Wm)(m,{type:"primary",link:"",size:"small",onClick:l=>n(e.row)},{default:(0,a.w5)((()=>[(0,a.Uk)("修改QP")])),_:2},1032,["onClick"]),(0,a.Wm)(m,{type:"primary",link:"",size:"small",onClick:l=>s(e.row)},{default:(0,a.w5)((()=>[(0,a.Uk)("修改PK段位")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[_,e.loading]]),(0,a.Wm)((0,o.SU)(v),{ref_key:"qpDialogRef",ref:t,onReloadRoles:d},null,512),(0,a.Wm)((0,o.SU)(y),{ref_key:"pvpDialogRef",ref:i,onReloadRoles:d},null,512)])}}});const q=U;var S=q,x=t(3498);const P={class:"tc-step-border"},R={class:"l"};var V=(0,a.aZ)({__name:"index",setup(e){const l=(0,o.qj)({data:[],loading:!1});let t=null;const u=e=>{t=e,r()},r=async()=>{try{l.loading=!0,l.data=await(0,d.F3)(t),l.loading=!1}catch(e){l.loading=!1}};return(e,t)=>((0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)((0,o.SU)(n.Z),{title:"角色管理"}),(0,a._)("div",P,[(0,a._)("div",R,[(0,a.Wm)((0,o.SU)(i.Z),{num:"1",title:"账号选择"},{default:(0,a.w5)((()=>[(0,a.Wm)((0,o.SU)(x.Z),{onSetUid:u})])),_:1}),(0,a.Wm)((0,o.SU)(i.Z),{num:"2",title:"角色信息","is-last":""},{default:(0,a.w5)((()=>[(0,a.Wm)((0,o.SU)(S),{data:l.data,loading:l.loading,onReloadRoles:r},null,8,["data","loading"])])),_:1})])])]))}});const C=V;var j=C},3498:function(e,l,t){t.d(l,{Z:function(){return c}});var a=t(3396),o=t(4870),n=t(7139),i=t(491),u=t(7192);const r={style:{float:"left"}},s={style:{float:"right",color:"var(--el-text-color-secondary)","font-size":"13px"}};var d=(0,a.aZ)({__name:"SelectAccount",props:{hasRole:{type:Boolean,default:!0},hasBtn:{type:Boolean,default:!0},labelWidth:{type:String,default:"100px"},enableEventChange:{type:Boolean,default:!1}},emits:["setUid"],setup(e,{emit:l}){const t=e,{hasRole:d,hasBtn:p,labelWidth:c}=(0,o.BK)(t),m=(0,o.iH)(),f=(0,o.qj)({uid:18000002}),_=(0,o.qj)({uid:[{required:!0,message:"请选择账号",trigger:"blur"}]}),w=(0,o.qj)({data:[]}),v=(0,o.iH)(!1),g=async()=>{v.value=!0,w.data=await(0,i.T8)({has_roles:d.value}),v.value=!1},b=async()=>{if(!t.enableEventChange)return;const e=await(0,u.Gu)(m);e&&l("setUid",f.uid)},h=async()=>{const e=await(0,u.Gu)(m);e&&l("setUid",f.uid)};return g(),(e,l)=>{const t=(0,a.up)("el-option"),i=(0,a.up)("el-select"),u=(0,a.up)("el-form-item"),d=(0,a.up)("el-button"),g=(0,a.up)("el-form");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(g,{model:f,rules:_,ref_key:"formRef",ref:m,"label-width":(0,o.SU)(c)},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{label:"账号ID",prop:"uid"},{default:(0,a.w5)((()=>[(0,a.Wm)(i,{modelValue:f.uid,"onUpdate:modelValue":l[0]||(l[0]=e=>f.uid=e),onChange:b,filterable:"",clearable:"",placeholder:"选择账号id",loading:v.value,"loading-text":"正在加载账号"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(w.data,(e=>((0,a.wg)(),(0,a.j4)(t,{key:e.uid,label:e.uid,value:e.uid},{default:(0,a.w5)((()=>[(0,a._)("span",r,(0,n.zw)(e.uid),1),(0,a._)("span",s," 角色数:"+(0,n.zw)(e.roles),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue","loading"])])),_:1}),(0,o.SU)(p)?((0,a.wg)(),(0,a.j4)(u,{key:0},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{type:"primary",onClick:h,size:"small"},{default:(0,a.w5)((()=>[(0,a.Uk)("查询")])),_:1})])),_:1})):(0,a.kq)("",!0)])),_:1},8,["model","rules","label-width"])])}}});const p=d;var c=p}}]);